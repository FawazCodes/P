<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced Interaction Test Page</title>
    <!-- Google Analytics (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-QZPVR2MV7X"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      // Your GA4 Configuration ID
      gtag('config', 'G-QZPVR2MV7X');

      // Track page views automatically
      function trackPageView() {
        gtag('event', 'page_view', {
          'page_title': document.title,
          'page_location': window.location.href,
          'page_path': window.location.pathname
        });
      }

      // Function to track option selections
      function trackOptionSelection(option) {
        gtag('event', 'select_content', {
          'content_type': 'option',
          'item_id': option
        });
      }

      // Function to track button clicks
      function trackButtonClick(buttonName) {
        gtag('event', 'button_click', {
          'event_category': 'Button',
          'event_label': buttonName
        });
      }

      // Function to track when the page visibility changes (e.g., tab change, window minimize)
      function trackVisibilityChange() {
        if (document.visibilityState === 'hidden') {
          gtag('event', 'leave_page', {
            'event_label': 'VisibilityChange',
            'event_category': 'Engagement',
            'non_interaction': true
          });
        }
      }

      document.addEventListener('visibilitychange', trackVisibilityChange);

      // Track scroll depth
      let trackedSections = {section1: false, section2: false, section3: false};
      function trackScrollDepth() {
        const scrollPosition = window.scrollY + window.innerHeight;
        Object.keys(trackedSections).forEach(section => {
          const elem = document.getElementById(section);
          if (scrollPosition > elem.offsetTop && !trackedSections[section]) {
            gtag('event', 'scroll_depth', {
              'event_category': 'Scroll',
              'event_label': section,
              'value': Math.round((scrollPosition / document.body.offsetHeight) * 100)
            });
            trackedSections[section] = true;
          }
        });
      }

      window.addEventListener('scroll', trackScrollDepth);

      // Track exit intent (e.g., mouse moving towards the window's top edge)
      function trackExitIntent(event) {
        // Only trigger for movements heading to the upper page boundary
        if (event.clientY < 50) {
          gtag('event', 'exit_intent', {
            'event_category': 'Engagement',
            'event_label': 'Mouse Out'
          });
        }
      }

      document.addEventListener('mouseout', trackExitIntent);

      // Ensure page view is tracked on initial load
      window.onload = trackPageView;
    </script>
</head>
<body>

<h1>Welcome to the Enhanced Interaction Test Page</h1>
<p>Interact with the elements below to generate tracking data. Text input is not tracked to ensure privacy.</p>

<!-- Dropdown for Option Selection -->
<div>
    <label for="options">Choose an option:</label>
    <select name="options" id="options" onchange="trackOptionSelection(this.value)">
        <option value="Option 1">Option 1</option>
        <option value="Option 2">Option 2</option>
        <option value="Option 3">Option 3</option>
    </select>
</div>

<!-- Textbox for Typing Simulation (Not Tracked) -->
<div>
    <label for="typingTest">Test Typing Here:</label>
    <input type="text" id="typingTest" name="typingTest" placeholder="Type something...">
</div>

<!-- Button for Click Tracking -->
<div>
    <button id="submitButton" onclick="trackButtonClick('Submit')">Submit</button>
</div>

<!-- Content Sections for Scroll Tracking -->
<section id="section1">
    <h2>Section 1</h2>
    <p>Content of Section 1. Scroll here to test engagement tracking.</p>
</section>

<section id="section2">
    <h2>Section 2</h2>
    <p>Content of Section 2. Continue scrolling and interacting.</p>
</section>

<section id="section3">
    <h2>Section 3</h2>
    <p>Content of Section 3. Final section for scroll depth tracking.</p>
</section>

</body>
</html>
